<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Setup the Nextcloud Snap Package with HTTPS and a separate data path | ExitCode0</title>
<meta name=keywords content="Linux,nextcloud,snap,snapcraft,ubuntu"><meta name=description content="
 https://snapcraft.io/nextcloud
I have been using the Nextcloud snap package for a long time, but some recent system changes in my colocation facility mean that it is time for a big upgrade. Rather than migrate my existing Nextcloud instance, I have decided to build a new install and here are my goals for the new installation:

Use lets encrypt to have automatic and valid HTTPS certificates
Have the data path for Nextcloud on a HDD and the rest of the host OS on an SSD.

Host OS Details
For this setup, I am using Ubuntu 18.04 installed on a 30GB SSD backed partition. I then have a 1TB disk attached and mounted to /media."><meta name=author content="Tom"><link rel=canonical href=https://exitcode0.net/posts/setup-the-nextcloud-snap-package-with-https-and-a-separate-data-path/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://exitcode0.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://exitcode0.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://exitcode0.net/favicon-32x32.png><link rel=apple-touch-icon href=https://exitcode0.net/apple-touch-icon.png><link rel=mask-icon href=https://exitcode0.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://exitcode0.net/posts/setup-the-nextcloud-snap-package-with-https-and-a-separate-data-path/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7745507566538945" crossorigin=anonymous></script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=exit data-description="Support me on Buy me a coffee!" data-message="Buy me a coffee" data-color=#FF813F data-position=Right data-x_margin=18 data-y_margin=165></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EDE9MPZR9T"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EDE9MPZR9T")}</script><meta property="og:title" content="Setup the Nextcloud Snap Package with HTTPS and a separate data path"><meta property="og:description" content="
 https://snapcraft.io/nextcloud
I have been using the Nextcloud snap package for a long time, but some recent system changes in my colocation facility mean that it is time for a big upgrade. Rather than migrate my existing Nextcloud instance, I have decided to build a new install and here are my goals for the new installation:

Use lets encrypt to have automatic and valid HTTPS certificates
Have the data path for Nextcloud on a HDD and the rest of the host OS on an SSD.

Host OS Details
For this setup, I am using Ubuntu 18.04 installed on a 30GB SSD backed partition. I then have a 1TB disk attached and mounted to /media."><meta property="og:type" content="article"><meta property="og:url" content="https://exitcode0.net/posts/setup-the-nextcloud-snap-package-with-https-and-a-separate-data-path/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-29T19:54:17+00:00"><meta property="article:modified_time" content="2020-03-29T19:54:17+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setup the Nextcloud Snap Package with HTTPS and a separate data path"><meta name=twitter:description content="
 https://snapcraft.io/nextcloud
I have been using the Nextcloud snap package for a long time, but some recent system changes in my colocation facility mean that it is time for a big upgrade. Rather than migrate my existing Nextcloud instance, I have decided to build a new install and here are my goals for the new installation:

Use lets encrypt to have automatic and valid HTTPS certificates
Have the data path for Nextcloud on a HDD and the rest of the host OS on an SSD.

Host OS Details
For this setup, I am using Ubuntu 18.04 installed on a 30GB SSD backed partition. I then have a 1TB disk attached and mounted to /media."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://exitcode0.net/posts/"},{"@type":"ListItem","position":2,"name":"Setup the Nextcloud Snap Package with HTTPS and a separate data path","item":"https://exitcode0.net/posts/setup-the-nextcloud-snap-package-with-https-and-a-separate-data-path/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Setup the Nextcloud Snap Package with HTTPS and a separate data path","name":"Setup the Nextcloud Snap Package with HTTPS and a separate data path","description":" https://snapcraft.io/nextcloud I have been using the Nextcloud snap package for a long time, but some recent system changes in my colocation facility mean that it is time for a big upgrade. Rather than migrate my existing Nextcloud instance, I have decided to build a new install and here are my goals for the new installation:\nUse lets encrypt to have automatic and valid HTTPS certificates Have the data path for Nextcloud on a HDD and the rest of the host OS on an SSD. Host OS Details For this setup, I am using Ubuntu 18.04 installed on a 30GB SSD backed partition. I then have a 1TB disk attached and mounted to /media.\n","keywords":["Linux","nextcloud","snap","snapcraft","ubuntu"],"articleBody":" https://snapcraft.io/nextcloud I have been using the Nextcloud snap package for a long time, but some recent system changes in my colocation facility mean that it is time for a big upgrade. Rather than migrate my existing Nextcloud instance, I have decided to build a new install and here are my goals for the new installation:\nUse lets encrypt to have automatic and valid HTTPS certificates Have the data path for Nextcloud on a HDD and the rest of the host OS on an SSD. Host OS Details For this setup, I am using Ubuntu 18.04 installed on a 30GB SSD backed partition. I then have a 1TB disk attached and mounted to /media.\nStep 1 – How to install Nextcloud Snap Package Snap is simple and effective, this one command gives you a basic install of Nextcloud (assuming that you have your DNS records and firewall rules in place at this point):\nsudo snap install nextcloud Do not visit the new site in your browser yet!\nStep 2 – Change the data directory to use another disk partition You must make sure that your secondary drive is mounted in /media or /mnt – as described in the Nextcloud snap wiki: https://github.com/nextcloud/nextcloud-snap/blob/master/README.md\nWhen you have you drive mounted, you will need to allow the snap instance to access ‘removable media’:\nsudo snap connect nextcloud:removable-media sudo chown -R root:root /media/ Now we need to edit the Nextcloud config to match this data directory:\nsudo nano /var/snap/nextcloud/current/nextcloud/config/autoconfig.php Here we must change the following line to reflect our data path:\n// ... 'directory' =\u003e '/media/', // ... Once you have exited and saves your changes to the config file, it is time to restart the service:\nsudo snap restart nextcloud.php-fpm Now it is safe to visit your Nextcloud URL!\nAt this point, you will be visiting a HTTP page and will be asked to create your default admin Nextcloud user. Feel free to do this.\nStep 3 – Enabling Lets Encrypt HTTPS for the Nextcloud Snap Package We now have a function Nextcloud server, but it is not secure. We need to enable HTTPS and generate a certificate with Lets Encrypt. Again, assuming that your DNS records and firewall rules are in order:\nsudo nextcloud.enable-https lets-encrypt Complete the steps by entering your recovery email address and the domain of the Nextcloud server and the tool will generate and apply your certificate. You only need to this once; Lets Encrypt handles auto-renewal.\nAt this point, you can refresh your browser and you will be auto-forward to the HTTPS version of your new Nextcloud sever.\nOther useful Nextcloud tutorials: Backup Nextcloud with RCLONE – https://exitcode0.net/posts/backup-nextcloud-with-rclone/ ","wordCount":"443","inLanguage":"en","datePublished":"2020-03-29T19:54:17Z","dateModified":"2020-03-29T19:54:17Z","author":{"@type":"Person","name":"Tom"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://exitcode0.net/posts/setup-the-nextcloud-snap-package-with-https-and-a-separate-data-path/"},"publisher":{"@type":"Organization","name":"ExitCode0","logo":{"@type":"ImageObject","url":"https://exitcode0.net/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://exitcode0.net/ accesskey=h title="ExitCode0 (Alt + H)">ExitCode0</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://datasolace.com/ title=DataSolace><span>DataSolace</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://exitcode0.net/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://exitcode0.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://exitcode0.net/privacy/ title=Privacy><span>Privacy</span></a></li><li><a href=https://exitcode0.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://exitcode0.net/>Home</a>&nbsp;»&nbsp;<a href=https://exitcode0.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Setup the Nextcloud Snap Package with HTTPS and a separate data path</h1><div class=post-meta><span title='2020-03-29 19:54:17 +0000 UTC'>March 29, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Tom</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#host-os-details aria-label="Host OS Details">Host OS Details</a></li><li><a href=#step-1--how-to-install-nextcloud-snap-package aria-label="Step 1 – How to install Nextcloud Snap Package">Step 1 – How to install Nextcloud Snap Package</a></li><li><a href=#step-2--change-the-data-directory-to-use-another-disk-partition aria-label="Step 2 – Change the data directory to use another disk partition">Step 2 – Change the data directory to use another disk partition</a></li><li><a href=#step-3--enabling-lets-encrypt-https-for-the-nextcloud-snap-package aria-label="Step 3 – Enabling Lets Encrypt HTTPS for the Nextcloud Snap Package">Step 3 – Enabling Lets Encrypt HTTPS for the Nextcloud Snap Package</a></li><li><a href=#other-useful-nextcloud-tutorials aria-label="Other useful Nextcloud tutorials:">Other useful Nextcloud tutorials:</a></li></ul></div></details></div><div class=post-content><p><a href=https://snapcraft.io/nextcloud title=https://snapcraft.io/nextcloud><img loading=lazy src="https://i1.wp.com/exitcode0.net/wp-content/uploads/2020/03/Nextcloud_Logo.svg_.png?resize=186%2C131" alt="Nextcloud Snap Package setup">
</a><a href=https://snapcraft.io/nextcloud title=https://snapcraft.io/nextcloud>https://snapcraft.io/nextcloud</a>
I have been using the Nextcloud snap package for a long time, but some recent system changes in my colocation facility mean that it is time for a big upgrade. Rather than migrate my existing Nextcloud instance, I have decided to build a new install and here are my goals for the new installation:</p><ul><li><strong>Use lets encrypt to have automatic and valid HTTPS certificates</strong></li><li><strong>Have the data path for Nextcloud on a HDD and the rest of the host OS on an SSD</strong>.</li></ul><h2 id=host-os-details>Host OS Details<a hidden class=anchor aria-hidden=true href=#host-os-details>#</a></h2><p>For this setup, I am using Ubuntu 18.04 installed on a 30GB SSD backed partition. I then have a 1TB disk attached and mounted to /media.</p><h2 id=step-1--how-to-install-nextcloud-snap-package>Step 1 – How to install Nextcloud Snap Package<a hidden class=anchor aria-hidden=true href=#step-1--how-to-install-nextcloud-snap-package>#</a></h2><p>Snap is simple and effective, this one command gives you a basic install of Nextcloud (assuming that you have your DNS records and firewall rules in place at this point):</p><pre tabindex=0><code>sudo snap install nextcloud
</code></pre><p><strong>Do not visit the new site in your browser yet!</strong></p><h2 id=step-2--change-the-data-directory-to-use-another-disk-partition>Step 2 – Change the data directory to use another disk partition<a hidden class=anchor aria-hidden=true href=#step-2--change-the-data-directory-to-use-another-disk-partition>#</a></h2><p>You <strong>must</strong> make sure that your secondary drive is mounted in <strong>/media</strong> or <strong>/mnt</strong> – as described in the Nextcloud snap wiki: <a href=https://github.com/nextcloud/nextcloud-snap/blob/master/README.md title=https://github.com/nextcloud/nextcloud-snap/blob/master/README.md>https://github.com/nextcloud/nextcloud-snap/blob/master/README.md</a></p><p>When you have you drive mounted, you will need to allow the snap instance to access ‘removable media’:</p><pre tabindex=0><code>sudo snap connect nextcloud:removable-media
</code></pre><pre tabindex=0><code>sudo chown -R root:root /media/&lt;my mount point&gt;
</code></pre><p>Now we need to edit the Nextcloud config to match this data directory:</p><pre tabindex=0><code>sudo nano /var/snap/nextcloud/current/nextcloud/config/autoconfig.php
</code></pre><p>Here we must change the following line to reflect our data path:</p><pre tabindex=0><code> // ...
 &#39;directory&#39; =&gt; &#39;/media/&lt;my mount point&gt;&#39;,
 // ...
</code></pre><p>Once you have exited and saves your changes to the config file, it is time to restart the service:</p><pre tabindex=0><code>sudo snap restart nextcloud.php-fpm
</code></pre><p><strong>Now it is safe to visit your Nextcloud URL</strong>!</p><p>At this point, you will be visiting a HTTP page and will be asked to create your default admin Nextcloud user. Feel free to do this.</p><h2 id=step-3--enabling-lets-encrypt-https-for-the-nextcloud-snap-package>Step 3 – Enabling Lets Encrypt HTTPS for the Nextcloud Snap Package<a hidden class=anchor aria-hidden=true href=#step-3--enabling-lets-encrypt-https-for-the-nextcloud-snap-package>#</a></h2><p>We now have a function Nextcloud server, but it is not secure. We need to enable HTTPS and generate a certificate with Lets Encrypt. Again, assuming that your DNS records and firewall rules are in order:</p><pre tabindex=0><code>sudo nextcloud.enable-https lets-encrypt
</code></pre><p>Complete the steps by entering your recovery email address and the domain of the Nextcloud server and the tool will generate and apply your certificate. You only need to this once; Lets Encrypt handles auto-renewal.</p><p><strong>At this point, you can refresh your browser and you will be auto-forward to the HTTPS version of your new Nextcloud sever.</strong></p><hr><h2 id=other-useful-nextcloud-tutorials>Other useful Nextcloud tutorials:<a hidden class=anchor aria-hidden=true href=#other-useful-nextcloud-tutorials>#</a></h2><ul><li>Backup Nextcloud with RCLONE – <a href=https://exitcode0.net/posts/backup-nextcloud-with-rclone/ title=https://exitcode0.net/posts/backup-nextcloud-with-rclone/>https://exitcode0.net/posts/backup-nextcloud-with-rclone/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://exitcode0.net/tags/linux/>Linux</a></li><li><a href=https://exitcode0.net/tags/nextcloud/>Nextcloud</a></li><li><a href=https://exitcode0.net/tags/snap/>Snap</a></li><li><a href=https://exitcode0.net/tags/snapcraft/>Snapcraft</a></li><li><a href=https://exitcode0.net/tags/ubuntu/>Ubuntu</a></li></ul><nav class=paginav><a class=prev href=https://exitcode0.net/posts/how-to-upgrade-ubuntu-from-18-04-to-20-04/><span class=title>« Prev</span><br><span>How to upgrade Ubuntu from 18.04 to 20.04</span>
</a><a class=next href=https://exitcode0.net/posts/prevent-screensavers-and-lock-screens-with-powershell/><span class=title>Next »</span><br><span>Prevent Screensavers and Lock-screens with Powershell</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://exitcode0.net/>ExitCode0</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>