<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Automatically pause Spotify with the 3CX client | ExitCode0</title>
<meta name=keywords content="3cx,autoit,spotify"><meta name=description content="This is a really old script that I just found in my archive, but it still works all the same. The goal was to write a small script that would automatically pause Spotify with the 3CX client when there was an inbound call.
The script is written in AutoIT, meaning that it is a Windows-only solution. The Windows 3CX CTI client allows you to run a particular executable when an inbound call is received, i.e. when the phone rings. I wanted to pause the manic euro beats so that I could answer my phone and here the caller and uphold professionalism."><meta name=author content="Tom"><link rel=canonical href=https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://exitcode0.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://exitcode0.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://exitcode0.net/favicon-32x32.png><link rel=apple-touch-icon href=https://exitcode0.net/apple-touch-icon.png><link rel=mask-icon href=https://exitcode0.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7745507566538945" crossorigin=anonymous></script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=exit data-description="Support me on Buy me a coffee!" data-message="Buy me a coffee" data-color=#FF813F data-position=Right data-x_margin=18 data-y_margin=165></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EDE9MPZR9T"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EDE9MPZR9T")}</script><meta property="og:title" content="Automatically pause Spotify with the 3CX client"><meta property="og:description" content="This is a really old script that I just found in my archive, but it still works all the same. The goal was to write a small script that would automatically pause Spotify with the 3CX client when there was an inbound call.
The script is written in AutoIT, meaning that it is a Windows-only solution. The Windows 3CX CTI client allows you to run a particular executable when an inbound call is received, i.e. when the phone rings. I wanted to pause the manic euro beats so that I could answer my phone and here the caller and uphold professionalism."><meta property="og:type" content="article"><meta property="og:url" content="https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-16T21:35:52+00:00"><meta property="article:modified_time" content="2020-05-16T21:35:52+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Automatically pause Spotify with the 3CX client"><meta name=twitter:description content="This is a really old script that I just found in my archive, but it still works all the same. The goal was to write a small script that would automatically pause Spotify with the 3CX client when there was an inbound call.
The script is written in AutoIT, meaning that it is a Windows-only solution. The Windows 3CX CTI client allows you to run a particular executable when an inbound call is received, i.e. when the phone rings. I wanted to pause the manic euro beats so that I could answer my phone and here the caller and uphold professionalism."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://exitcode0.net/posts/"},{"@type":"ListItem","position":2,"name":"Automatically pause Spotify with the 3CX client","item":"https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Automatically pause Spotify with the 3CX client","name":"Automatically pause Spotify with the 3CX client","description":"This is a really old script that I just found in my archive, but it still works all the same. The goal was to write a small script that would automatically pause Spotify with the 3CX client when there was an inbound call.\nThe script is written in AutoIT, meaning that it is a Windows-only solution. The Windows 3CX CTI client allows you to run a particular executable when an inbound call is received, i.e. when the phone rings. I wanted to pause the manic euro beats so that I could answer my phone and here the caller and uphold professionalism.\n","keywords":["3cx","autoit","spotify"],"articleBody":"This is a really old script that I just found in my archive, but it still works all the same. The goal was to write a small script that would automatically pause Spotify with the 3CX client when there was an inbound call.\nThe script is written in AutoIT, meaning that it is a Windows-only solution. The Windows 3CX CTI client allows you to run a particular executable when an inbound call is received, i.e. when the phone rings. I wanted to pause the manic euro beats so that I could answer my phone and here the caller and uphold professionalism.\nThe AutoIT Code ; ***************************************************************************** ; Auto Pause Spotify ; Pauses spotify when called ; Author: Tom Cocking - www.tomcocking.com ; ***************************************************************************** #include SpotifyPause() Func SpotifyPause() ; Retrieve the handle of the Spotify window using the classname of SpotifyMainWindow. Local $hWnd: WinGetHandle(\"[CLASS:SpotifyMainWindow]\") WinActivate($hWnd) Local $sText: WinGetTitle(\"[ACTIVE]\") If $sText: \"Spotify\" Then Exit Else Send(\"{SPACE}\") Exit EndIf If @error Then ConsoleWrite(\"An error occurred when trying to retrieve the window handle of Spotify\") Exit EndIf EndFunc As you can see, the code is very straight forward and to the point; we are asking 3CX to run the compiled exe file every time there is an inbound call, fast and reliable code is essential. It is also really important that you conclude you executable with an exit statement to prevent stale processes lingering on your system.\nOne subtle thing that this script does is check if the Spotify instance has a song/artist data in the window title (which would signal that music was playing) before trying to activate the window and pause playback. One thing to mention – it would be a lot easier if there was a global hotkey to play/pause music, particularly one that Spotify adhered to. This would make this script 3 lines long (not counting comments).\nEditors Note: I fully intend on uploading this to a public Github repository so that you can clone the repo, rather than just copying/pasting.\nConfigure the 3CX softphone client Once you have compiled your script into an executable file, you can find the setting in the 3CX client to run an exe upon an incoming call. So when you have a call from the boss, you can rest easy knowing that your secret adoration for Taylor Swift remains undisclosed.\nplease recognise my sarcasm\nYou can find more useful AutoIT snippets over on my Code Samples Page.\n","wordCount":"404","inLanguage":"en","datePublished":"2020-05-16T21:35:52Z","dateModified":"2020-05-16T21:35:52Z","author":{"@type":"Person","name":"Tom"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/"},"publisher":{"@type":"Organization","name":"ExitCode0","logo":{"@type":"ImageObject","url":"https://exitcode0.net/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://exitcode0.net/ accesskey=h title="ExitCode0 (Alt + H)">ExitCode0</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://datasolace.com/ title=DataSolace><span>DataSolace</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://exitcode0.net/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://exitcode0.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://exitcode0.net/privacy/ title=Privacy><span>Privacy</span></a></li><li><a href=https://exitcode0.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://exitcode0.net/>Home</a>&nbsp;»&nbsp;<a href=https://exitcode0.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Automatically pause Spotify with the 3CX client</h1><div class=post-meta><span title='2020-05-16 21:35:52 +0000 UTC'>May 16, 2020</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Tom</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#configure-the-3cx-softphone-client aria-label="Configure the 3CX softphone client">Configure the 3CX softphone client</a></li></ul></div></details></div><div class=post-content><p>This is a really old script that I just found in my archive, but it still works all the same. The goal was to write a small script that would automatically pause Spotify with the <a href=https://www.3cx.com/voip/softphone/ title=https://www.3cx.com/voip/softphone/>3CX client</a> when there was an inbound call.</p><p>The script is written in AutoIT, meaning that it is a Windows-only solution. The Windows 3CX CTI client allows you to run a particular executable when an inbound call is received, i.e. when the phone rings. I wanted to pause the manic euro beats so that I could answer my phone and here the caller and uphold professionalism.</p><h2 id=the-autoit-code><img loading=lazy src="https://i0.wp.com/exitcode0.net/wp-content/uploads/2020/05/autopause-1.jpg?fit=760%2C506&amp;ssl=1" alt="Automatically pause Spotify with the 3CX client - exitcode0">
The AutoIT Code</h2><pre tabindex=0><code>; *****************************************************************************
; Auto Pause Spotify
; Pauses spotify when called
; Author: Tom Cocking - www.tomcocking.com
; *****************************************************************************
#include &lt;MsgBoxConstants.au3&gt;
SpotifyPause()

Func SpotifyPause()
; Retrieve the handle of the Spotify window using the classname of SpotifyMainWindow.
    Local $hWnd: WinGetHandle(&#34;[CLASS:SpotifyMainWindow]&#34;)
	WinActivate($hWnd)
	Local $sText: WinGetTitle(&#34;[ACTIVE]&#34;)

	If $sText: &#34;Spotify&#34; Then
	   Exit
	Else
	   Send(&#34;{SPACE}&#34;)
	   Exit
	EndIf

    If @error Then
        ConsoleWrite(&#34;An error occurred when trying to retrieve the window handle of Spotify&#34;)
        Exit
    EndIf
EndFunc
</code></pre><p>As you can see, the code is very straight forward and to the point; we are asking 3CX to run the compiled exe file every time there is an inbound call, fast and reliable code is essential. It is also really important that you conclude you executable with an exit statement to prevent stale processes lingering on your system.</p><p>One subtle thing that this script does is check if the Spotify instance has a song/artist data in the window title (which would signal that music was playing) before trying to activate the window and pause playback. One thing to mention – it would be a lot easier if there was a global hotkey to play/pause music, particularly one that Spotify adhered to. This would make this script 3 lines long (not counting comments).</p><p><strong>Editors Note:</strong> I fully intend on uploading this to a public Github repository so that you can clone the repo, rather than just copying/pasting.</p><h3 id=configure-the-3cx-softphone-client>Configure the 3CX softphone client<a hidden class=anchor aria-hidden=true href=#configure-the-3cx-softphone-client>#</a></h3><p>Once you have compiled your script into an executable file, you can find the setting in the 3CX client to run an exe upon an incoming call. So when you have a call from the boss, you can rest easy knowing that your secret adoration for Taylor Swift remains undisclosed.</p><p><img loading=lazy src="https://i0.wp.com/exitcode0.net/wp-content/uploads/2020/05/tenor-1.gif?resize=268%2C268&amp;ssl=1" alt>
please recognise my sarcasm</p><hr><p>You can find more useful AutoIT snippets over on my <a href=https://exitcode0.net/code-samples/ title=https://exitcode0.net/code-samples/>Code Samples Page</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://exitcode0.net/tags/3cx/>3cx</a></li><li><a href=https://exitcode0.net/tags/autoit/>Autoit</a></li><li><a href=https://exitcode0.net/tags/spotify/>Spotify</a></li></ul><nav class=paginav><a class=prev href=https://exitcode0.net/posts/copy-paste-in-vsphere-before-installing-vmware-tools/><span class=title>« Prev</span><br><span>Copy Paste in vSphere before installing VMware tools</span>
</a><a class=next href=https://exitcode0.net/posts/python-3-ssh-with-paramiko/><span class=title>Next »</span><br><span>Python 3 SSH with Paramiko</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://exitcode0.net/>ExitCode0</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>