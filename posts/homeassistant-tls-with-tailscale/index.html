<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale | ExitCode0</title>
<meta name=keywords content><meta name=description content="Tailscale is a virtual private network (VPN) service that allows secure remote access to resources across different networks. It offers a feature called MagicDNS that enables you to access your resources using a domain name instead of an IP address. Additionally, you can use HTTPS certificates to encrypt traffic between clients and servers, ensuring secure communication. In this tutorial, we&rsquo;ll explain how to enable MagicDNS and HTTPS certificates in Tailscale and how to add a TLS certificate to Home Assistant using Tailscale.
The most practical benifit for using Home Assistant within a Tailscale network is that it removes the requirement for network port forwarding and exposing services publicly, whilst still allowing your devices to access it from outside your local network. This blog post aims to give you the starting stes required to setup MagicDNS and HTTPS certificates in Tailscale, create a certificate on your home server and install that certificate in a Home Assistant docker container."><meta name=author content="Tom C"><link rel=canonical href=https://exitcode0.net/posts/homeassistant-tls-with-tailscale/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://exitcode0.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://exitcode0.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://exitcode0.net/favicon-32x32.png><link rel=apple-touch-icon href=https://exitcode0.net/apple-touch-icon.png><link rel=mask-icon href=https://exitcode0.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://exitcode0.net/posts/homeassistant-tls-with-tailscale/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7745507566538945" crossorigin=anonymous></script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=exit data-description="Support me on Buy me a coffee!" data-message="Buy me a coffee" data-color=#FF813F data-position=Right data-x_margin=18 data-y_margin=165></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EDE9MPZR9T"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EDE9MPZR9T")}</script><meta property="og:title" content="Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale"><meta property="og:description" content="Tailscale is a virtual private network (VPN) service that allows secure remote access to resources across different networks. It offers a feature called MagicDNS that enables you to access your resources using a domain name instead of an IP address. Additionally, you can use HTTPS certificates to encrypt traffic between clients and servers, ensuring secure communication. In this tutorial, we&rsquo;ll explain how to enable MagicDNS and HTTPS certificates in Tailscale and how to add a TLS certificate to Home Assistant using Tailscale.
The most practical benifit for using Home Assistant within a Tailscale network is that it removes the requirement for network port forwarding and exposing services publicly, whilst still allowing your devices to access it from outside your local network. This blog post aims to give you the starting stes required to setup MagicDNS and HTTPS certificates in Tailscale, create a certificate on your home server and install that certificate in a Home Assistant docker container."><meta property="og:type" content="article"><meta property="og:url" content="https://exitcode0.net/posts/homeassistant-tls-with-tailscale/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-10T12:00:00+01:00"><meta property="article:modified_time" content="2023-05-10T12:00:00+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale"><meta name=twitter:description content="Tailscale is a virtual private network (VPN) service that allows secure remote access to resources across different networks. It offers a feature called MagicDNS that enables you to access your resources using a domain name instead of an IP address. Additionally, you can use HTTPS certificates to encrypt traffic between clients and servers, ensuring secure communication. In this tutorial, we&rsquo;ll explain how to enable MagicDNS and HTTPS certificates in Tailscale and how to add a TLS certificate to Home Assistant using Tailscale.
The most practical benifit for using Home Assistant within a Tailscale network is that it removes the requirement for network port forwarding and exposing services publicly, whilst still allowing your devices to access it from outside your local network. This blog post aims to give you the starting stes required to setup MagicDNS and HTTPS certificates in Tailscale, create a certificate on your home server and install that certificate in a Home Assistant docker container."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://exitcode0.net/posts/"},{"@type":"ListItem","position":2,"name":"Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale","item":"https://exitcode0.net/posts/homeassistant-tls-with-tailscale/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale","name":"Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale","description":"Tailscale is a virtual private network (VPN) service that allows secure remote access to resources across different networks. It offers a feature called MagicDNS that enables you to access your resources using a domain name instead of an IP address. Additionally, you can use HTTPS certificates to encrypt traffic between clients and servers, ensuring secure communication. In this tutorial, we\u0026rsquo;ll explain how to enable MagicDNS and HTTPS certificates in Tailscale and how to add a TLS certificate to Home Assistant using Tailscale. The most practical benifit for using Home Assistant within a Tailscale network is that it removes the requirement for network port forwarding and exposing services publicly, whilst still allowing your devices to access it from outside your local network. This blog post aims to give you the starting stes required to setup MagicDNS and HTTPS certificates in Tailscale, create a certificate on your home server and install that certificate in a Home Assistant docker container.\n","keywords":[],"articleBody":"Tailscale is a virtual private network (VPN) service that allows secure remote access to resources across different networks. It offers a feature called MagicDNS that enables you to access your resources using a domain name instead of an IP address. Additionally, you can use HTTPS certificates to encrypt traffic between clients and servers, ensuring secure communication. In this tutorial, we’ll explain how to enable MagicDNS and HTTPS certificates in Tailscale and how to add a TLS certificate to Home Assistant using Tailscale. The most practical benifit for using Home Assistant within a Tailscale network is that it removes the requirement for network port forwarding and exposing services publicly, whilst still allowing your devices to access it from outside your local network. This blog post aims to give you the starting stes required to setup MagicDNS and HTTPS certificates in Tailscale, create a certificate on your home server and install that certificate in a Home Assistant docker container.\nWHY?! Why do I want a valid TLS certificate and a HTTPS connection to Home Assistant without a browser warning? Per the 2023.5 relase (https://www.home-assistant.io/blog/2023/05/03/release-20235/) voice control is all the rage using local voice assistants; in order to use the microphone in a modern browser connected to you Home Assistant dashboard, you need to have a valid HTTPS connection!\nEnabling MagicDNS Sign in to your Tailscale admin console and select your network. Click on “Nodes” and select the node that you want to enable MagicDNS for (You might only have one default node like me). Under “DNS” click “Enable MagicDNS.” Once you’ve enabled MagicDNS, you can access your devices using the tailnet domain allocated to your network. For example, mypc.exampletail.ts.net, where mypc is the device name.\nEnabling HTTPS Certificates Navigate to the DNS page of the admin console. Under HTTPS Certificates, click Enable HTTPS. Acknowledge that your machine names and your tailnet name will be published on a public ledger. Once you’ve enabled HTTPS certificates, you can generate the certificate and private key by running the following command on each machine (linux):\nsudo tailscale cert xxxx.xxxx.ts.net Replace xxxx.xxxx.ts.net with your tailnet domain, found on the DNS page of the admin console.\nThis will download two files: xxxx.xxxx.ts.net.crt and xxxx.xxxx.ts.net.key.\nAdding the TLS Certificate to Home Assistant To add the TLS certificate to Home Assistant, you need to convert the private key to PEM format and copy the certificate files to the Home Assistant container’s SSL directory. The following steps are based on a docker compose installation of HA, assuming the .crt and .key files created above are stored in /home/user/ (your file path will likely differ).\nConvert the private key to PEM format using the following command: sudo openssl pkcs8 -topk8 -nocrypt -in /home/user/xxxx.xxxx.ts.net.key -out /home/user/private.pem Replace /home/user/xxxx.xxxx.ts.net.key with the path to the downloaded key file.\nMake a directory for the TLS certificate files in the Home Assistant container’s file structure: mkdir /home/user/docker/homeassistant/ssl Add a volume mapping for the newly created ssl folder to your docker-compose.yml file, this will be where Home Assistant stores and locates the TLS certificate files: volumes: - /home/user/docker/homeassistant/ssl:/ssl You might alreaady have other volumes like I do for config and data; we are just adding another in this step.\nCopy the certificate files to the TLS directory: sudo cp /home/user/xxxx.xxxx.ts.net.crt /home/user/docker/homeassistant/ssl/fullchain.pem sudo cp /home/user/private.pem /home/user/docker/homeassistant/ssl/privkey.pem Replace /home/user/xxxx.xxxx.ts.net.crt with the path to the downloaded certificate file.\nUpdate the Home Assistant configuration.yml file to include the SSL certificate and key paths: http: ssl_certificate: /ssl/fullchain.pem ssl_key: /ssl/private.pem Save the file and restart the Home Assistant container:\ndocker compose up -d Now, you should be able to access Home Assistant securely using the MagicDNS domain name: https://mypc.example.ts.net:8123/.\nNOTE: You will need to be accessing this URL from a Tailscale connected device which is configured to use Tailscale DNS!\n","wordCount":"626","inLanguage":"en","datePublished":"2023-05-10T12:00:00+01:00","dateModified":"2023-05-10T12:00:00+01:00","author":{"@type":"Person","name":"Tom C"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://exitcode0.net/posts/homeassistant-tls-with-tailscale/"},"publisher":{"@type":"Organization","name":"ExitCode0","logo":{"@type":"ImageObject","url":"https://exitcode0.net/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://exitcode0.net/ accesskey=h title="ExitCode0 (Alt + H)">ExitCode0</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://datasolace.com/ title=DataSolace><span>DataSolace</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://exitcode0.net/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://exitcode0.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://exitcode0.net/privacy/ title=Privacy><span>Privacy</span></a></li><li><a href=https://exitcode0.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://exitcode0.net/>Home</a>&nbsp;»&nbsp;<a href=https://exitcode0.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Homeassistant Enable MagicDNS and HTTPS Certificates in Tailscale</h1><div class=post-meta><span title='2023-05-10 12:00:00 +0100 +0100'>May 10, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Tom C</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#enabling-magicdns aria-label="Enabling MagicDNS">Enabling MagicDNS</a></li><li><a href=#enabling-https-certificates aria-label="Enabling HTTPS Certificates">Enabling HTTPS Certificates</a></li><li><a href=#adding-the-tls-certificate-to-home-assistant aria-label="Adding the TLS Certificate to Home Assistant">Adding the TLS Certificate to Home Assistant</a></li></ul></div></details></div><div class=post-content><p>Tailscale is a virtual private network (VPN) service that allows secure remote access to resources across different networks. It offers a feature called MagicDNS that enables you to access your resources using a domain name instead of an IP address. Additionally, you can use HTTPS certificates to encrypt traffic between clients and servers, ensuring secure communication. In this tutorial, we&rsquo;ll explain how to enable MagicDNS and HTTPS certificates in Tailscale and how to add a TLS certificate to Home Assistant using Tailscale.
The most practical benifit for using Home Assistant within a Tailscale network is that it removes the requirement for network port forwarding and exposing services publicly, whilst still allowing your devices to access it from outside your local network. This blog post aims to give you the starting stes required to setup MagicDNS and HTTPS certificates in Tailscale, create a certificate on your home server and install that certificate in a Home Assistant docker container.</p><p><strong>WHY?!</strong> Why do I want a valid TLS certificate and a HTTPS connection to Home Assistant without a browser warning? Per the 2023.5 relase (<a href=https://www.home-assistant.io/blog/2023/05/03/release-20235/>https://www.home-assistant.io/blog/2023/05/03/release-20235/</a>) voice control is all the rage using local voice assistants; in order to use the microphone in a modern browser connected to you Home Assistant dashboard, you need to have a valid HTTPS connection!</p><h2 id=enabling-magicdns>Enabling MagicDNS<a hidden class=anchor aria-hidden=true href=#enabling-magicdns>#</a></h2><ol><li>Sign in to your Tailscale admin console and select your network.</li><li>Click on &ldquo;Nodes&rdquo; and select the node that you want to enable MagicDNS for (You might only have one default node like me).</li><li>Under &ldquo;DNS&rdquo; click &ldquo;Enable MagicDNS.&rdquo;</li></ol><p>Once you&rsquo;ve enabled MagicDNS, you can access your devices using the tailnet domain allocated to your network. For example, <code>mypc.exampletail.ts.net</code>, where <code>mypc</code> is the device name.</p><h2 id=enabling-https-certificates>Enabling HTTPS Certificates<a hidden class=anchor aria-hidden=true href=#enabling-https-certificates>#</a></h2><ol><li>Navigate to the DNS page of the admin console.</li><li>Under HTTPS Certificates, click Enable HTTPS.</li><li>Acknowledge that your machine names and your tailnet name will be published on a public ledger.</li></ol><p><img loading=lazy src=/images/tailscale-https-certificates.png alt="HTTPS enabled in the Tailscale admin console"></p><p>Once you&rsquo;ve enabled HTTPS certificates, you can generate the certificate and private key by running the following command on each machine (linux):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo tailscale cert xxxx.xxxx.ts.net
</span></span></code></pre></div><p>Replace <code>xxxx.xxxx.ts.net</code> with your tailnet domain, found on the DNS page of the admin console.</p><p>This will download two files: <code>xxxx.xxxx.ts.net.crt</code> and <code>xxxx.xxxx.ts.net.key</code>.</p><h2 id=adding-the-tls-certificate-to-home-assistant>Adding the TLS Certificate to Home Assistant<a hidden class=anchor aria-hidden=true href=#adding-the-tls-certificate-to-home-assistant>#</a></h2><p>To add the TLS certificate to Home Assistant, you need to convert the private key to PEM format and copy the certificate files to the Home Assistant container&rsquo;s SSL directory. The following steps are based on a docker compose installation of HA, assuming the <code>.crt</code> and <code>.key</code> files created above are stored in <code>/home/user/</code> (your file path will likely differ).</p><ol><li>Convert the private key to PEM format using the following command:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo openssl pkcs8 -topk8 -nocrypt -in /home/user/xxxx.xxxx.ts.net.key -out /home/user/private.pem
</span></span></code></pre></div><p>Replace <code>/home/user/xxxx.xxxx.ts.net.key</code> with the path to the downloaded key file.</p><ol start=2><li>Make a directory for the TLS certificate files in the Home Assistant container&rsquo;s file structure:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir /home/user/docker/homeassistant/ssl
</span></span></code></pre></div><ol start=3><li>Add a volume mapping for the newly created ssl folder to your <code>docker-compose.yml</code> file, this will be where Home Assistant stores and locates the TLS certificate files:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>/home/user/docker/homeassistant/ssl:/ssl</span>
</span></span></code></pre></div><p>You might alreaady have other volumes like I do for config and data; we are just adding another in this step.</p><ol start=4><li>Copy the certificate files to the TLS directory:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cp /home/user/xxxx.xxxx.ts.net.crt /home/user/docker/homeassistant/ssl/fullchain.pem
</span></span><span style=display:flex><span>sudo cp /home/user/private.pem /home/user/docker/homeassistant/ssl/privkey.pem
</span></span></code></pre></div><p>Replace <code>/home/user/xxxx.xxxx.ts.net.crt</code> with the path to the downloaded certificate file.</p><ol start=5><li>Update the Home Assistant <code>configuration.yml</code> file to include the SSL certificate and key paths:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ssl_certificate</span>: <span style=color:#ae81ff>/ssl/fullchain.pem</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ssl_key</span>: <span style=color:#ae81ff>/ssl/private.pem</span>
</span></span></code></pre></div><p>Save the file and restart the Home Assistant container:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose up -d
</span></span></code></pre></div><p>Now, you should be able to access Home Assistant securely using the MagicDNS domain name: <a href=https://mypc.example.ts.net:8123/>https://mypc.example.ts.net:8123/</a>.</p><p><img loading=lazy src=/images/ha-https-connection.png alt="HTTPS Connection to Home Assistant over Tailscale"></p><p><strong>NOTE:</strong> You will need to be accessing this URL from a Tailscale connected device which is configured to use Tailscale DNS!</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://exitcode0.net/posts/wyoming-whisper-docker-compose/><span class=title>« Prev</span><br><span>How to Use a Docker Compose File for Wyoming Whisper</span>
</a><a class=next href=https://exitcode0.net/posts/esxi-nvme-disk-passthrough/><span class=title>Next »</span><br><span>Passing Through an NVMe Drive to an ESXi Virtual Machine</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://exitcode0.net/>ExitCode0</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>