<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Copy Paste in vSphere before installing VMware tools | ExitCode0</title>
<meta name=keywords content="autoit,code,vsphere"><meta name=description content="

I’ve spent enough time building VMs in vSphere to know that the first few minutes between starting the VM and getting VMware Tools installed is agonising. Similar to my ‘Copy Paste With Powershell Sendkeys‘ script, I have another tool written in AutoIT which sends defined keyboard strokes to the system. So this is not exactly ‘copy paste in vSphere’, but it achieves the same goal."><meta name=author content="Tom"><link rel=canonical href=https://exitcode0.net/posts/copy-paste-in-vsphere-before-installing-vmware-tools/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://exitcode0.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://exitcode0.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://exitcode0.net/favicon-32x32.png><link rel=apple-touch-icon href=https://exitcode0.net/apple-touch-icon.png><link rel=mask-icon href=https://exitcode0.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://exitcode0.net/posts/copy-paste-in-vsphere-before-installing-vmware-tools/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7745507566538945" crossorigin=anonymous></script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=exit data-description="Support me on Buy me a coffee!" data-message="Buy me a coffee" data-color=#FF813F data-position=Right data-x_margin=18 data-y_margin=165></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EDE9MPZR9T"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EDE9MPZR9T")}</script><meta property="og:title" content="Copy Paste in vSphere before installing VMware tools"><meta property="og:description" content="

I’ve spent enough time building VMs in vSphere to know that the first few minutes between starting the VM and getting VMware Tools installed is agonising. Similar to my ‘Copy Paste With Powershell Sendkeys‘ script, I have another tool written in AutoIT which sends defined keyboard strokes to the system. So this is not exactly ‘copy paste in vSphere’, but it achieves the same goal."><meta property="og:type" content="article"><meta property="og:url" content="https://exitcode0.net/posts/copy-paste-in-vsphere-before-installing-vmware-tools/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-18T18:30:00+00:00"><meta property="article:modified_time" content="2020-05-18T18:30:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Copy Paste in vSphere before installing VMware tools"><meta name=twitter:description content="

I’ve spent enough time building VMs in vSphere to know that the first few minutes between starting the VM and getting VMware Tools installed is agonising. Similar to my ‘Copy Paste With Powershell Sendkeys‘ script, I have another tool written in AutoIT which sends defined keyboard strokes to the system. So this is not exactly ‘copy paste in vSphere’, but it achieves the same goal."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://exitcode0.net/posts/"},{"@type":"ListItem","position":2,"name":"Copy Paste in vSphere before installing VMware tools","item":"https://exitcode0.net/posts/copy-paste-in-vsphere-before-installing-vmware-tools/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Copy Paste in vSphere before installing VMware tools","name":"Copy Paste in vSphere before installing VMware tools","description":" I’ve spent enough time building VMs in vSphere to know that the first few minutes between starting the VM and getting VMware Tools installed is agonising. Similar to my ‘Copy Paste With Powershell Sendkeys‘ script, I have another tool written in AutoIT which sends defined keyboard strokes to the system. So this is not exactly ‘copy paste in vSphere’, but it achieves the same goal.\n","keywords":["autoit","code","vsphere"],"articleBody":" I’ve spent enough time building VMs in vSphere to know that the first few minutes between starting the VM and getting VMware Tools installed is agonising. Similar to my ‘Copy Paste With Powershell Sendkeys‘ script, I have another tool written in AutoIT which sends defined keyboard strokes to the system. So this is not exactly ‘copy paste in vSphere’, but it achieves the same goal.\nIf you actually want to enable clipboard sync between host and VM, you can follow this guide here: Enable Copy and Paste Operations Between the Guest Operating System and Remote Console. This is going to need VMware Tools installed on the host though.\nCopy Paste in vSphere with AutoIT Yes this tool is written in AutoIT, apparently my favorite script kiddie language from the 201X years, so Windows only on this one – sorry. Quite a simple bit of code, we prompt for the text we want to put on the ‘clipboard’ announce the waiting period before sending the keystrokes (allowing the user time to place the cursor in the VM) and then fire off the keystrokes.\n#include Local $sAnswer: InputBox(\"Send Keys\", \"Enter the text you want to send:\", \"\", \"\", _ - 1, -1, 0, 0) Local $iTimeout: 7 Local $iSecUntil: 10 MsgBox($MB_SYSTEMMODAL, \"Send Keys\", \"Your keys will be sent in \" \u0026 $iSecUntil \u0026 \" seconds or select the OK button to start a 3 second countdown.\", $iTimeout) Sleep(3000) Send($sAnswer) Exit Code Enhancements? This tool has got me out of a number of binds where the clipboard has failed me – usually some form of remote session. I don’t trust myself to type things accurately in high-pressure situations, especially when character obfuscation is in play.\nAt the moment this is a one-shot executable; you run it once and then the process terminates. One handy feature/enhancement would be to have it run perpetually and listen for a hotkey (definable) on the host triggering the main function of the code to be called.\nThat being said, there are lots of other things I am working on right now, and digging back into an AutoIT project from 2016 is not very high on the priorities list. Perhaps one for a rainy day…\nMore AutoIT ramblings: Automatically pause Spotify with the 3CX client – https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/ ","wordCount":"379","inLanguage":"en","datePublished":"2020-05-18T18:30:00Z","dateModified":"2020-05-18T18:30:00Z","author":{"@type":"Person","name":"Tom"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://exitcode0.net/posts/copy-paste-in-vsphere-before-installing-vmware-tools/"},"publisher":{"@type":"Organization","name":"ExitCode0","logo":{"@type":"ImageObject","url":"https://exitcode0.net/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://exitcode0.net/ accesskey=h title="ExitCode0 (Alt + H)">ExitCode0</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://datasolace.com/ title=DataSolace><span>DataSolace</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://exitcode0.net/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://exitcode0.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://exitcode0.net/privacy/ title=Privacy><span>Privacy</span></a></li><li><a href=https://exitcode0.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://exitcode0.net/>Home</a>&nbsp;»&nbsp;<a href=https://exitcode0.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Copy Paste in vSphere before installing VMware tools</h1><div class=post-meta><span title='2020-05-18 18:30:00 +0000 UTC'>May 18, 2020</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Tom</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#copy-paste-in-vsphere-with-autoit aria-label="Copy Paste in vSphere with AutoIT">Copy Paste in vSphere with AutoIT</a><ul><li><a href=#code-enhancements aria-label="Code Enhancements?">Code Enhancements?</a></li></ul></li><li><a href=#more-autoit-ramblings aria-label="More AutoIT ramblings:">More AutoIT ramblings:</a></li></ul></div></details></div><div class=post-content><p><img loading=lazy src="https://i0.wp.com/exitcode0.net/wp-content/uploads/2020/05/clipboard.png?resize=168%2C246&amp;ssl=1" alt="Copy Paste in vSphere">
I’ve spent enough time building VMs in vSphere to know that the first few minutes between starting the VM and getting VMware Tools installed is agonising. Similar to my ‘<a href=https://exitcode0.net/posts/copy-paste-with-powershell-sendkeys/ title=https://exitcode0.net/posts/copy-paste-with-powershell-sendkeys/>Copy Paste With Powershell Sendkeys</a>‘ script, I have another tool written in AutoIT which sends defined keyboard strokes to the system. So this is not <em>exactly</em> ‘copy paste in vSphere’, but it achieves the same goal.</p><p>If you actually want to enable clipboard sync between host and VM, you can follow this guide here: <a href="https://pubs.vmware.com/vsphere-50/index.jsp?topic=%2Fcom.vmware.vsphere.security.doc_50%2FGUID-367D02C1-B71F-4AC3-AA05-85033136A667.html" title="https://pubs.vmware.com/vsphere-50/index.jsp?topic=%2Fcom.vmware.vsphere.security.doc_50%2FGUID-367D02C1-B71F-4AC3-AA05-85033136A667.html">Enable Copy and Paste Operations Between the Guest Operating System and Remote Console</a>. This is going to need VMware Tools installed on the host though.</p><h2 id=copy-paste-in-vsphere-with-autoit>Copy Paste in vSphere with AutoIT<a hidden class=anchor aria-hidden=true href=#copy-paste-in-vsphere-with-autoit>#</a></h2><p>Yes this tool is written in AutoIT, apparently my favorite script kiddie language from the 201X years, so Windows only on this one – sorry. Quite a simple bit of code, we prompt for the text we want to put on the ‘clipboard’ announce the waiting period before sending the keystrokes (allowing the user time to place the cursor in the VM) and then fire off the keystrokes.</p><pre tabindex=0><code>#include &lt;MsgBoxConstants.au3&gt;

Local $sAnswer: InputBox(&#34;Send Keys&#34;, &#34;Enter the text you want to send:&#34;, &#34;&#34;, &#34;&#34;, _
             - 1, -1, 0, 0)
Local $iTimeout: 7
Local $iSecUntil: 10
MsgBox($MB_SYSTEMMODAL, &#34;Send Keys&#34;, &#34;Your keys will be sent in &#34; &amp; $iSecUntil &amp; &#34; seconds or select the OK button to start a 3 second countdown.&#34;, $iTimeout)
Sleep(3000)
Send($sAnswer)
Exit
</code></pre><h3 id=code-enhancements>Code Enhancements?<a hidden class=anchor aria-hidden=true href=#code-enhancements>#</a></h3><p>This tool has got me out of a number of binds where the clipboard has failed me – usually some form of remote session. I don’t trust myself to type things accurately in high-pressure situations, especially when character obfuscation is in play.</p><p>At the moment this is a one-shot executable; you run it once and then the process terminates. One handy feature/enhancement would be to have it run perpetually and listen for a hotkey (definable) on the host triggering the main function of the code to be called.</p><p>That being said, there are <strong>lots</strong> of other things I am working on right now, and digging back into an AutoIT project from 2016 is not very high on the priorities list. Perhaps one for a rainy day…</p><hr><h2 id=more-autoit-ramblings>More AutoIT ramblings:<a hidden class=anchor aria-hidden=true href=#more-autoit-ramblings>#</a></h2><ul><li>Automatically pause Spotify with the 3CX client – <a href=https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/ title=https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/>https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://exitcode0.net/tags/autoit/>Autoit</a></li><li><a href=https://exitcode0.net/tags/code/>Code</a></li><li><a href=https://exitcode0.net/tags/vsphere/>Vsphere</a></li></ul><nav class=paginav><a class=prev href=https://exitcode0.net/posts/how-to-raspberry-pi-boot-from-usb/><span class=title>« Prev</span><br><span>How To: Raspberry Pi boot from USB</span>
</a><a class=next href=https://exitcode0.net/posts/automatically-pause-spotify-with-the-3cx-client/><span class=title>Next »</span><br><span>Automatically pause Spotify with the 3CX client</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://exitcode0.net/>ExitCode0</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>